{extend name="common/common"/}
{block name="body-menu"}
<div class="vernav2 iconmenu">
    <ul>
        <li class="has-sub">
            <a href="#open">
                <i class="fa fa-list-alt"></i>SEO设置<i class="fa fa-angle-down"></i>
            </a>
            <ul id="open" class="sub-menu">
                <li>
                    <a href="admin/index/keywords">
                        <i class="fa fa-angle-right"></i>网站管理
                    </a>
                </li>
                <!--<li>-->
                <!--<a href="admin/index/title">-->
                <!--<i class="fa fa-angle-right"></i>网站标题管理-->
                <!--</a>-->
                <!--</li>-->
            </ul>
        </li>
    </ul>
    <ul>
        <li class="has-sub">
            <a href="#url">
                <i class="fa fa-list-alt"></i>友情链接设置<i class="fa fa-angle-down"></i>
            </a>
            <ul id="url" class="sub-menu">
                <li>
                    <a href="admin/index/friendlyurl">
                        <i class="fa fa-angle-right"></i>友情链接管理
                    </a>
                </li>
                <!--<li>-->
                <!--<a href="admin/index/title">-->
                <!--<i class="fa fa-angle-right"></i>网站标题管理-->
                <!--</a>-->
                <!--</li>-->
            </ul>
        </li>
    </ul>
</div>
{/block}
{block name="body-main"}
<div class="pageheader notab">
    <if condition='#'>

        <else/>
        <h1 class="pagetitle">友情链接管理 <small><a href="admin/index/edit">添加链接</a></small></h1>
    </if>
</div>

<div id="contentwrapper" class="contentwrapper">

    <div class="contenttitle2">
        <h3>列表</h3>
    </div>

    <table class="table table-striped table-bordered table-hover no-footer" >
        <thead>
        <tr>
            <th>链接名</th>
            <th>url</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
            {volist name="list" id="vo"}
            <tr>
                <input type="hidden" name="id" value="{$vo['Id']}">
                <td class="gai" style="text-align: left">
                    <input type="text" style="border:none" readonly="readonly" name="name" value="{$vo['name']}">
                </td>
                <td class="gai"><input class="textbtn" type="text" style="border:none" readonly="readonly" name="url" value="{$vo['url']}"></td>
                <td width="200">
                    <input type="button" class="btn btn-xs  btn-primary xiugai" value="修改" >
                    <input type="button" class="btn btn-xs  btn-primary baocun" value="保存"  style="display: none">
                    <input type="button" class="btn btn-xs btn-danger delete" value="删除">
                </td>
            </tr>
            {/volist}
        </tbody>
    </table>
    <ul class="pagination">
    </ul>
</div>
{/block}
{block name="footer-ext"}
<script>
    (function($){
        $(document).ready(function() {
            $(".xiugai").click(function (e) {
                var btn = e.target;
                var count = $($($(btn).parent().get(0)).siblings(".gai")).length;
                for(var i = 0;i<count;i++){
                    var cbtn =$($($(btn).parent().get(0)).siblings(".gai")).children().get(i);
                    $(cbtn).removeAttr("readonly");
                    $(cbtn).css("border","1px solid rgb(71,145,255)");
                }
                var baocun =$(btn).siblings(".baocun").get(0);
                $(baocun).show();
                $(btn).css("display","none");
            })
            $(".delete").click(function (e) {
                var btn = e.target;
                $(btn).parent().parent().remove();
                var title = $(btn).parent().prev().prev().prev().val();
                $.get(
                    'admin/index/dodeleteurl',
                    {
                        id:title,
                    },
                    function (data) {
                        alert(data);
                    }
                );
            })
            $(".baocun").click(function (e) {
                var btn = e.target;
                var describe = $(btn).parent().prev().children().val();
                var key = $(btn).parent().prev().prev().children().val();
                var title = $(btn).parent().prev().prev().prev().val();
                // var site = $(btn).parent().prev().prev().prev().prev().val();
                // alert('url-'+describe + '--name-'+key+'--id-'+title);
                $.get(
                    'admin/index/doediturl',
                    {
                        id:title,
                        name : key,
                        url:describe
                    },
                    function (data) {
                        alert(data);
                    }
                );
                var count = $($($(btn).parent().get(0)).siblings(".gai")).length;
                for(var i = 0;i<count;i++){
                    var cbtn =$($($(btn).parent().get(0)).siblings(".gai")).children().get(i);
                    $(cbtn).attr("readonly","readonly");
                    $(cbtn).css("border","none");
                }
                var xiugai = $(btn).siblings(".xiugai").get(0);
                $(btn).hide();
                $(xiugai).show();
            })
        })
    })(jQuery)
</script>
{/block}
