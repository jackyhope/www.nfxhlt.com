{extend name="public/common" /}
{block name="body"}
<!--新闻中心-->
<div class="newscenter set-h">
    <div class="banner">
        <img src="__STATIC__/mobile/images/news/BG.png" alt="资讯中心banner">
    </div>
    <div class="news">
        <div class="newshead">
            <ul>
                <li onclick="newstype(this)"><h1 class="newscheck">企业新闻</h1></li>
                <li onclick="newstype(this)"><h1>行业资讯</h1></li>
            </ul>
        </div>
        <div class="newslist" onscroll="shownews()">

            {volist name="data" id="vo"}
            <div class="news-c">
                <!--<a href="{:url('mobile/detail/index',['name'=>$vo.id])}">-->
                <a href="/mobile/detail/index?name={$vo.id}">
                    <img src="__STATIC__/images/news/{$vo.imgname.name}" alt="">
                    <h1>
                        {$vo.title}
                    </h1>
                    <span class="newstime">
                        {$vo.time|date='Y-m-d',###}
                    </span>
                    <span class="newscontent">
                        {$vo.subtitle}
                    </span>
                </a>
            </div>
            {/volist}
        </div>
    </div>
</div>
<script type="text/javascript">
    function  shownews() {
        var banner = $(".banner");
        var news = $(".news");
        var navh = $(".menu").height();
        var top = news.offset().top;
        banner.addClass("b-h");
        news.addClass("n-s");
    }
    function newstype(data) {
        var li = $($(data).children());
        $(".newscheck").removeClass('newscheck');
        li.addClass("newscheck");
        if(li.html()=='企业新闻'){
            $.ajax({
                url:"index",
                type:"post",
                data:{type:1},
                datatype:"json",
                error:function () {
                    console.log("error");
                },
                success:function (data,status) {
                    $(".newslist").children().remove();
                    for(let i = 0;i<data.length;i++){
                        $(".newslist").append("<div class='news-c'> <a href='/mobile/detail/index?name="+data[i]['id']+"'> <img src='__STATIC__/images/news/"+data[i]['imgname']['name']+"' alt=''> <h1>"+data[i]["title"]+"</h1> <span class='newstime'>"+format(data[i]["time"])+"</span> <span class='newscontent'>"+data[i]["subtitle"]+"</span> </a> </div>");
                    }
                }
            })
        }else if(li.html()=='行业资讯'){
            $.ajax({
                url:"index",
                type:"post",
                data:{type:2},
                datatype:"json",
                error:function () {
                    console.log("error");
                },
                success:function (data,status) {
                    $(".newslist").children().remove();
                    for(let i = 0;i<data.length;i++){
                        $(".newslist").append("<div class='news-c'> <a href='/mobile/detail/index?name="+data[i]['id']+"'> <img src='__STATIC__/images/news/"+data[i]['imgname']['name']+"' alt=''> <h1>"+data[i]["title"]+"</h1> <span class='newstime'>"+format(data[i]["time"])+"</span> <span class='newscontent'>"+data[i]["subtitle"]+"</span> </a> </div>");
                    }
                }
            })
        }
    }
    function add0(m){return m<10?'0'+m:m }
    function format(timestamp)
    {
        //timestamp是整数，否则要parseInt转换,不会出现少个0的情况
        var time = new Date(timestamp*1000);
        var year = time.getFullYear();
        var month = time.getMonth()+1;
        var date = time.getDate();
        var hours = time.getHours();
        var minutes = time.getMinutes();
        var seconds = time.getSeconds();
        return year+'-'+add0(month)+'-'+add0(date)/*+' '+add0(hours)+':'+add0(minutes)+':'+add0(seconds)*/;
    }
</script>
{/block}